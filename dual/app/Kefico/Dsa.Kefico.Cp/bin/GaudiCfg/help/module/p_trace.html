<HTML>
<HEAD>
<TITLE>P_TRACE</TITLE>
<META NAME="Generator" CONTENT="KDOC ">
</HEAD>
<BODY bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#000099" alink= "#ffffff">

<table BORDER=0 COLS=1 WIDTH="100%" BGCOLOR="#FFFFCC" NOSAVE >
<tr ALIGN=CENTER VALIGN=CENTER NOSAVE>
<td NOSAVE><font face="Arial,Helvetica"><font size=+2></font></font>
<br><font face="Arial,Helvetica"><font size=+2>CCS Modul &nbsp;&nbsp;<b>P_TRACE</b></font></font>
<br>&nbsp;</td>
</tr>
</table>
<PRE>
   $Id: p_trace.C,v 1.6 2006/01/05 10:51:36 cvs Exp $
   ---------------------------------------------------------------------
   Kurzbeschreibung: 	Für Traceing auf K-Line und CAN
   ---------------------------------------------------------------------
   Projekt:		CCS
   Sourcefile:		p_trace.C
   Autor:		RtW2/TEF72-Keppler (12.08.2005)
   Zielsystem:		HP9000/V743 (HP-RT 3.01), Linux
   Sprache:		ANSI-C/C++
   ---------------------------------------------------------------------
   Prototyp:
   
   int  p_trace
   (shm_stringpointer *zeilen_wert	// &lt;I&gt; Inputfield of INTERPRETERLIST
   ,long  index1			// &lt;I&gt; INDEX in list
   ,long anzahl)			// &lt;I&gt; Number of Elements for Loaddfile
   
   ---------------------------------------------------------------------
   Aufruf:
   
   error = p_trace
   (zeilen_wert	// &lt;I&gt; Inputfield of INTERPRETERLIST
   ,index1	// &lt;I&gt; INDEX in list
   ,anzahl)	// &lt;I&gt; Number of Elements for Loaddfile
   
   if (error != 0) 	// Fehlerbeschreibung ... 
   {
   // Fehlerhandling ... 
   }
   
   ---------------------------------------------------------------------
   Function description:
   
   This modul handel's the the tracing on the K-Line and on CAN. 
   You can start the tracing with TRACE_MODE=T_ON. The Prüfliste is going on. 
   You can stop the tracing and read back the traced data with TRACE_MODE=READ.
   Tracing on CAN: 
   It is possible to trace all date received on a defined CAN-ID. All 
   traced data are stored in a file hold on the SKM. 
   It is possible to trace more then one ID. But the traced Data are hold
   in different files/buffers, one for each CAN-ID.
   In a second step you can read back the data from SKM and store in a 
   array. 
   Tracing on K-Line:
   It is possible to trace all received Bytes on the K-Line. It is not 
   possible to send parallel to the tacing data to the ECU over the k-line.
   
   Parameter discription :
   
   Inputparameter:</pre><b><a name="param1">1</a> FILENAME:</b><pre>     It means the filename used in the SKM for storing the traced 
                     data. (maxlen = 80 Char.)</pre><b><a name="param2">2</a> FILESIZE:</b><pre>     Size of the file in Byte. (0...100000)
                     If the number of the traced data reach the filesize, the 
                     tracing will be stopped.</pre><b><a name="param3">3</a> TR_INTERFACE:</b><pre>Type of communication-line.
                     CAN = tracing on CAN
                     K   = tracing on K-Line</pre><b><a name="param4">4</a> TRACE_MODE:</b><pre>  T_ON = switch on tracing all received data.
                            This module is leave after setting up the job. 
                            If you want to trace 5 Seconds, you have to insert 
                            a waitingtime for 5 seconds after this module. 
                     READ= Switch off tracing and read data from file &lt;FILENAME&gt;. 
                        All data are transfered from the SKM-File to the array in
                        &lt;RETURNARRAY&gt;
                        ATTENTION: If you want to read data, the Inputparameter must be the
                        same as in TRACE_MODE=T_ON, because the buffername is build in dependence 
                        of the Inputparameter.</pre><b><a name="param5">5</a> CAN_ID:</b><pre>      Read-Identifier on CAN-bus which should be traced.</pre><b><a name="param6">6</a> CAN_IDLEN:</b><pre>   [11,29] 11/29 bit identifier.</pre><b><a name="param7">7</a> MAXTIME:</b><pre>     Maximal time to trace. [ms]
                     Is this time up, the trace will be end. 
    
   Returnparameter:</pre><b><a name="param8">8</a> RETURNARRAY:</b><pre> The return parameter from the SKM are stored here, if
                     MODE=READ_DATA.</pre><b><a name="param9">9</a> ERROR:</b><pre>       != 0 if an error has occured.
                

</PRE>
</BODY>
</HTML>
